FROM python:3.9-slim-buster  # Or a suitable Python base image (e.g., python:3.11-slim-bullseye)

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

# Set environment variables (CRITICAL: Use environment variables for sensitive data)
ENV SECRET_KEY=your_django_secret_key  # Replace with your actual secret key
ENV DATABASE_URL=your_database_url  # Example: postgres://user:password@host:port/database
ENV ALLOWED_HOSTS=your-app-name.herokuapp.com,your-railway-app-url.up.railway.app,* # Replace with your allowed hosts

# Collect static files (if you have any)
RUN python manage.py collectstatic --noinput

# Run database migrations
RUN python manage.py migrate

# Expose the port your application will listen on
EXPOSE 8000  # Or the port you configured in your Django settings

# Start your Django application using Gunicorn
CMD gunicorn your_project.wsgi:application  # Replace with your WSGI entry point